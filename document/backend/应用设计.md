# 具体设计部分

流程：  

1. 需求初步解析  
2. 数据库设计
3. API设计  
4. 服务层设计  
5. 数据访问层设计  
6. 数据模型设计  
7. 数据转移对象设计  
8. 实现与测试迭代  

## 需求初步分析

[应用场景考虑](./应用场景考虑.md)  

### 功能模块大致划分

1. 原始问答模块  
2. 标准问题模块  
3. 候选答案模块  
4. 标准答案模块  
5. 评估结果模块  
6. 评估结果分析模块  

#### 部分基础功能约定

查询相关功能支持  

1. 分页查询：基础
2. 排序查询：需要支持部分属性  
3. 筛选查询：部分属性支持筛选查询  

#### 原始问答模块

1. 原始问题  
    1. 支持导入  
        如果导入？首先手动选择支持数据平台  
        因而可以确定数据格式  
        之后选择api进行导入  
    2. 支持查询  
        1. 排序依据：id
        2. 筛选依据：status(未转化、已转化、已忽略)  
2. 原始答案  
    1. 支持导入  
        导入时需要关联原始问题  
    2. 支持查询
        1. 排序依据：id  

#### 标准问题模块

此处考虑获得的标准问题必须来源于原始问题，  
且有相关的原始问题ID关联。  

1. 版本  
    1. 创建  
        手动创建  
        且必须在标准问题导入之前  
2. 标准问题  
    1. 支持导入
        1. 导入时必须指定版本
        2. 导入时需要关联原始问题  
    2. 支持查询  
        1. 排序依据：id  
        2. 筛选依据:  
            1. type
            2. status(等待答案、有答案)  
            3. version  
            4. tags  
3. tags
    1. 应该如何处理比较好呢？  
        总之当前的设计是单独有一张表保存tags，并且与标准问题表关联  
        一个问题可以有多个tags  
        具体应该怎么处理逻辑呢  

#### 候选答案模块

候选答案经过考虑之后决定也分表出专门用于存储不同答案内容的表  

此处与后面标准答案一样，都可以直接将主观题与客观题直接分为两种来看  
导入考虑分开处理，查询也只能分两种，不能放一起  

1. 候选答案
    1. 支持导入  
        导入会稍微复杂一些，需要根据问题类型来导入  
        主要分为：主观题and客观题  
        导入时或许需要进行拆分，以将内容存储进单独的表  
        1. 导入时需要关联标准问题  
        2. 导入时可能需要进行复杂一些的数据转换以实现多表导入  
    2. 支持查询：  
        1. 排序依据：id, std_question_id  
        2. 筛选依据：  
            1. status  

#### 标准答案模块

标准答案不接收直接导入  
只能考虑从候选答案中选择  

1. 标准答案  
    1. 支持创建  
        1. 考虑某个页面可以直接对候选答案进行选择  
        2. 创建时关联标准问题  
        3. 创建时关联候选答案  
        4. 创建时可能需要指定分数？  
    2. 支持查询  
        1. 排序依据：id, std_question_id  
        2. 筛选依据：
            1. status(ACCEPTED, OMITTED)  

#### 评估结果模块

1. 评估结果tags
    1. 支持创建  
        1. 手动创建  
        2. 必须在导入之前创建  
        3. 需要联系数据集版本  
2. 评估结果
    1. 支持导入  
        1. 导入时需要关联标准问题  
        2. 导入时需要选择某个评估结果tags  
    2. 支持查询  
        1. 排序依据：id, std_question_id  
        2. 筛选依据：  
            1. status(PENDING, ANALYZED, OMITTED)  
            2. tag_id  
            3. type  
                因为此处如果也要弄分表的话太麻烦，考虑到这对大模型评估不是问题  
                因此加一个type属性方便直接与标准答案连表  

#### 评估结果分析模块

1. 评估结果分析tags
    1. 支持创建  
        1. 手动创建  
        2. 必须在分析导入之前创建  
        3. 必须需要选择相关的结果tag进行关联  
2. 评估结果分析  
    1. 支持导入  
        1. 导入时必须选择相关的评估结果tag  
        2. 导入时必须与相关的结果id进行关联  
    2. 支持查询  
        1. 这个表可能需要再考虑考虑  

## 数据库设计

已经有了初步的关系模型了  
[数据库设计](../database/LLMEval.sql)  
可能再开发中对部分模块会进行调整  

## API设计

[API初稿](../api/api.md)  
[API改进](../api/api_improved.md)  
[API简单参考](../api/api_simple_reference.md)  

## 服务层设计

[服务层设计](../layer/service.md)  

## 数据访问层设计

[DAO](../layer/dao.md)  

## 数据模型设计

[Entity](../layer/entity.md)  

## 数据转移对象设计

[DTO](../layer/dto.md)  

## 实现计划

[后端开发计划](./后端开发计划.md)  
